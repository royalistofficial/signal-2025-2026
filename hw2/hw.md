# Решения ДЗ 2 -- Канальное кодирование

## Задача 1. Расширенный код Хэмминга (8, 4)

### 1.1. Порождающая матрица

Берем код Хэмминга (7, 4) в систематической форме G = (I_4 | P):

|   | 1 | 2 | 3 | 4 | 5 | 6 | 7 |
|---|---|---|---|---|---|---|---|
| g1| 1 | 0 | 0 | 0 | 1 | 1 | 0 |
| g2| 0 | 1 | 0 | 0 | 1 | 0 | 1 |
| g3| 0 | 0 | 1 | 0 | 0 | 1 | 1 |
| g4| 0 | 0 | 0 | 1 | 1 | 1 | 1 |

Расширение: добавляем 8-й бит -- проверку на четность (сумма всех бит строки = 0 mod 2):

    g1: вес 3 (нечетный) -> добавляем 1
    g2: вес 3 (нечетный) -> добавляем 1
    g3: вес 3 (нечетный) -> добавляем 1
    g4: вес 4 (четный)   -> добавляем 0

Порождающая матрица расширенного кода (8, 4):

|   | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
|---|---|---|---|---|---|---|---|---|
| g1| 1 | 0 | 0 | 0 | 1 | 1 | 0 | 1 |
| g2| 0 | 1 | 0 | 0 | 1 | 0 | 1 | 1 |
| g3| 0 | 0 | 1 | 0 | 0 | 1 | 1 | 1 |
| g4| 0 | 0 | 0 | 1 | 1 | 1 | 1 | 0 |

### 1.2. Все кодовые слова и их веса

Вычисляем c = m * G для всех 16 информационных слов:

| #  | m    | кодовое слово | вес |
|----|------|---------------|-----|
| 0  | 0000 | 00000000      | 0   |
| 1  | 1000 | 10001101      | 4   |
| 2  | 0100 | 01001011      | 4   |
| 3  | 0010 | 00100111      | 4   |
| 4  | 0001 | 00011110      | 4   |
| 5  | 1100 | 11000110      | 4   |
| 6  | 1010 | 10101010      | 4   |
| 7  | 1001 | 10010011      | 4   |
| 8  | 0110 | 01101100      | 4   |
| 9  | 0101 | 01010101      | 4   |
| 10 | 0011 | 00111001      | 4   |
| 11 | 1110 | 11100001      | 4   |
| 12 | 1101 | 11011000      | 4   |
| 13 | 1011 | 10110100      | 4   |
| 14 | 0111 | 01110010      | 4   |
| 15 | 1111 | 11111111      | 8   |

Распределение весов: 1 слово веса 0, 14 слов веса 4, 1 слово веса 8.

Примеры вычислений:

    m=1100: g1 XOR g2 = 10001101 XOR 01001011 = 11000110
    m=1010: g1 XOR g3 = 10001101 XOR 00100111 = 10101010
    m=1111: g1 XOR g2 XOR g3 XOR g4 = 11100001 XOR 00011110 = 11111111

### 1.3. Минимальное расстояние

    d_min = минимальный вес ненулевого слова = 4

Код исправляет t = floor((4-1)/2) = 1 ошибку и обнаруживает до 3 ошибок.

### 1.4. Расстояния между всеми парами

Код линейный, поэтому d(x, y) = w(x XOR y), а x XOR y -- тоже кодовое слово. Все ненулевые кодовые слова имеют вес 4 или 8. Значит расстояние между любыми двумя различными словами = 4 или 8.

Расстояние = 8 только когда x XOR y = 11111111, т.е. y = NOT x. Это 8 комплементарных пар:

    (0000, 1111), (1000, 0111), (0100, 1011), (0010, 1101),
    (0001, 1110), (1100, 0011), (1010, 0101), (1001, 0110)

(указаны информационные слова m)

Итого: 8 пар с расстоянием 8, остальные C(16,2) - 8 = 112 пар с расстоянием 4.

---

## Задача 2. Дуальный код Хэмминга -- симплексный код

### Определение

Код Хэмминга с параметром r имеет проверочную матрицу H размера r x (2^r - 1), столбцы которой -- все ненулевые двоичные векторы длины r.

Дуальный код: G_дуальный = H_Хэмминга. Параметры:

    n = 2^r - 1,   k = r

### Доказательство: все ненулевые слова имеют вес 2^(r-1)

Кодовое слово c = m * H, где m -- ненулевой вектор длины r.

j-й элемент: c_j = скалярное произведение <m, v_j>, где v_j -- j-й столбец H (j-й ненулевой вектор из GF(2)^r).

Вес c = число столбцов v, для которых <m, v> = 1.

Рассмотрим линейную функцию f(v) = <m, v> на GF(2)^r для ненулевого m:

    ker(f) = {v : <m, v> = 0} -- подпространство размерности (r-1)
    |ker(f)| = 2^(r-1)
    |{v : f(v) = 1}| = 2^r - 2^(r-1) = 2^(r-1)

Нулевой вектор всегда в ker(f), т.е. f(0) = 0. Среди ненулевых векторов:

    f(v) = 0 для 2^(r-1) - 1 штук
    f(v) = 1 для 2^(r-1) штук   (все они ненулевые)

Значит w(c) = 2^(r-1) для любого ненулевого m.   QED

### Проверка на примере: r = 3, код (7, 3)

G = H_Хэмминга:

|   | 1 | 2 | 3 | 4 | 5 | 6 | 7 |
|---|---|---|---|---|---|---|---|
| g1| 0 | 0 | 0 | 1 | 1 | 1 | 1 |
| g2| 0 | 1 | 1 | 0 | 0 | 1 | 1 |
| g3| 1 | 0 | 1 | 0 | 1 | 0 | 1 |

Все кодовые слова:

| m   | кодовое слово | вес |
|-----|---------------|-----|
| 000 | 0000000       | 0   |
| 001 | 1010101       | 4   |
| 010 | 0110011       | 4   |
| 100 | 0001111       | 4   |
| 011 | 1100110       | 4   |
| 101 | 1011010       | 4   |
| 110 | 0111100       | 4   |
| 111 | 1101001       | 4   |

Все 7 ненулевых слов имеют вес 4 = 2^(3-1) = 2^2. Расстояние между любыми двумя различными словами = вес их XOR = вес ненулевого слова = 4.

Код действительно симплексный.   QED

---

## Задача 3. Дуальный код к коду с проверкой на четность

### Исходный код: проверка на четность (n, n-1)

    G_исходный = (I_(n-1) | столбец единиц)   -- размер (n-1) x n
    H_исходный = (1 1 1 ... 1)                 -- размер 1 x n

### Построение дуального кода

По определению дуального кода:

    G_дуальный = H_исходный = (1 1 1 ... 1)
    H_дуальный = G_исходный = (I_(n-1) | столбец единиц)

### Характеристики

    n = n   (длина та же)
    k = 1   (одна строка в G)

### Число кодовых слов

    2^k = 2^1 = 2

Кодовые слова:

    m = 0:  c = (0 0 0 ... 0)
    m = 1:  c = (1 1 1 ... 1)

Это код с повторением: единственный информационный бит повторяется n раз.

### Минимальное расстояние и корректирующая способность

    d_min = w(1 1 1 ... 1) = n

    t = floor((n - 1) / 2)

Код исправляет до floor((n-1)/2) ошибок методом голосования по большинству.

### Пример: n = 7

    Дуальный код: (7, 1)
    Кодовые слова: {0000000, 1111111}
    d_min = 7
    t = floor(6/2) = 3 -- исправляет до 3 ошибок
    Скорость R = 1/7

### Замечание о дуальности

Исходный код (n, n-1) с d_min = 2 и дуальный (n, 1) с d_min = n -- два крайних случая: максимальная скорость / минимальная защита vs. минимальная скорость / максимальная защита.
