# Конспект лекции 2: Канальное кодирование

## 1. Напоминание: порождающая матрица линейного кода

Порождающая матрица G линейного (n, k)-кода имеет размер k x n. Строки G -- базисные векторы линейного подпространства кодовых слов.

Кодовые слова -- линейные комбинации строк G. Для кодирования информационное слово m = (m1, ..., mk) умножается на G:

    c = m * G

Результат -- кодовое слово c = (c1, ..., cn).

## 2. Напоминание: проверка и проверочная матрица

Проверка -- вектор h длины n, такой что для любого кодового слова c из кода C:

    c1*h1 + c2*h2 + ... + cn*hn = 0   (в GF(2))

Так как любое кодовое слово -- линейная комбинация строк G, то:

    G * h^T = 0   (нулевой столбец длины k)

---

## 3. Размерность пространства проверок

Матрица G размера k x n имеет k линейно независимых строк, значит ранг G = k. Ранг по строкам = ранг по столбцам, значит в G ровно k линейно независимых столбцов.

Индексы этих k линейно независимых столбцов образуют информационную совокупность. Остальные (n - k) индексов -- проверочная совокупность.

Размерность пространства проверок = n - k. Значит проверочная матрица H имеет размер (n - k) x n.

---

## 4. Систематическая форма

Над матрицей G можно выполнять элементарные преобразования (перестановка строк, сложение строк, перестановка столбцов), не меняющие сути кода.

Систематическая форма порождающей матрицы:

    G_сист = ( I_k | P )

где I_k -- единичная матрица размера k x k, P -- матрица размера k x (n-k).

Для кода в систематической форме проверочная матрица:

    H_сист = ( P^T | I_(n-k) )

Основное свойство: G * H^T = 0.

### Пример

Исходная матрица G для кода (6, 3):

|   | 1 | 2 | 3 | 4 | 5 | 6 |
|---|---|---|---|---|---|---|
| g1| 1 | 0 | 1 | 0 | 1 | 0 |
| g2| 1 | 1 | 0 | 0 | 0 | 1 |
| g3| 0 | 1 | 1 | 0 | 1 | 0 |

Для приведения к систематическому виду меняем местами столбцы так, чтобы на позициях 1-3 оказалась единичная матрица. Получаем:

|   | 1 | 2 | 3 | 4 | 5 | 6 |
|---|---|---|---|---|---|---|
| g1| 1 | 0 | 0 | 1 | 1 | 0 |
| g2| 0 | 1 | 0 | 1 | 0 | 1 |
| g3| 0 | 0 | 1 | 0 | 1 | 1 |

Здесь I_3 -- левая часть, P -- правая:

P:

|   | 1 | 2 | 3 |
|---|---|---|---|
|   | 1 | 1 | 0 |
|   | 1 | 0 | 1 |
|   | 0 | 1 | 1 |

Проверочная матрица H = (P^T | I_3):

|   | 1 | 2 | 3 | 4 | 5 | 6 |
|---|---|---|---|---|---|---|
| h1| 1 | 1 | 0 | 1 | 0 | 0 |
| h2| 1 | 0 | 1 | 0 | 1 | 0 |
| h3| 0 | 1 | 1 | 0 | 0 | 1 |

Важно: если столбцы переставлялись при приведении G к систематическому виду, то те же перестановки нужно сделать и в H (или обратить их для возврата к исходному порядку).

---

## 5. Минимальное расстояние через проверочную матрицу

Напоминание: минимальное расстояние линейного кода:

    d_min = min по всем m != 0 : w(m * G)

Число кодовых слов = 2^k (для двоичного кода). При большом k перебирать все слова дорого.

Ключевое наблюдение: если кодовое слово c имеет вес w, то при умножении c * H^T = 0 участвуют ровно w столбцов матрицы H (на позициях единиц в c). Их сумма должна дать ноль, значит эти w столбцов линейно зависимы.

Отсюда: d_min = минимальное число линейно зависимых столбцов H.

### Теорема

Минимальное расстояние линейного (n, k)-кода равно d тогда и только тогда, когда любые (d - 1) столбцов проверочной матрицы линейно независимы и существует набор из d линейно зависимых столбцов.

---

## 6. Граница Синглтона

Ранг матрицы H равен (n - k), значит максимум (n - k) столбцов могут быть линейно независимыми. Набор из (n - k + 1) столбцов обязательно линейно зависим.

### Теорема (граница Синглтона)

Минимальное расстояние линейного (n, k)-кода удовлетворяет:

    d_min <= n - k + 1

---

## 7. Дуальный код

Дуальный код к данному коду -- это код, порождающая матрица которого является проверочной матрицей исходного кода.

Если исходный код -- (n, k)-код, то дуальный код -- (n, n-k)-код:

    G_дуальный = H_исходный
    H_дуальный = G_исходный

---

## 8. Код проверки на четность -- код (n, n-1)

Проверочная матрица -- строка из n единиц (размер 1 x n):

    H = (1 1 1 ... 1)

Порождающая матрица -- единичная матрица I_(n-1) с добавленным столбцом единиц:

    G = ( I_(n-1) | столбец единиц )

Свойства:

- d_min = 2 (все кодовые слова имеют четный вес).
- Может обнаружить любые ошибки нечетного веса.
- Не может исправить ни одну ошибку.

---

## 9. Коды Хэмминга

### Построение

Рассмотрим задачу: построить код, исправляющий любые одиночные ошибки.

Если передано кодовое слово c, в канале произошла одна ошибка на позиции j (вектор ошибки e с единственной единицей на позиции j), то принято y = c + e. Вычислим:

    y * H^T = c * H^T + e * H^T = 0 + e * H^T = j-й столбец H

Идея: если столбцы H -- двоичные записи чисел от 1 до n, то результат y * H^T сразу дает номер ошибочной позиции.

### Пример: r = 3 (код Хэмминга (7, 4))

Проверочная матрица H (размер 3 x 7) -- столбцы представляют все ненулевые двоичные числа длины 3:

|   | 1 | 2 | 3 | 4 | 5 | 6 | 7 |
|---|---|---|---|---|---|---|---|
| h1| 0 | 0 | 0 | 1 | 1 | 1 | 1 |
| h2| 0 | 1 | 1 | 0 | 0 | 1 | 1 |
| h3| 1 | 0 | 1 | 0 | 1 | 0 | 1 |

Столбец 1 = (001) = 1, столбец 2 = (010) = 2, ..., столбец 7 = (111) = 7.

Если ошибка на позиции 4, то y * H^T = (100) -- двоичное представление числа 4. Зная позицию, исправляем ошибку.

### Параметры кодов Хэмминга

Параметр r (число строк H, r >= 2):

    n = 2^r - 1
    k = 2^r - 1 - r
    d_min = 3   (исправляет 1 ошибку)

| r | n  | k  | (n, k) |
|---|----|----|--------|
| 2 | 3  | 1  | (3,1) -- код проверки на четность / повторения |
| 3 | 7  | 4  | (7,4)  |
| 4 | 15 | 11 | (15,11)|
| 5 | 31 | 26 | (31,26)|

Свойства кода Хэмминга:

- В каждой строке H число единиц одинаково и равно 2^(r-1).
- Коды Хэмминга оптимальны: не существует кодов (даже нелинейных) с большим числом кодовых слов при d_min = 3 и той же длине n.

---

## 10. Симплексный код (дуальный к коду Хэмминга)

Дуальный код к коду Хэмминга -- это код, у которого G = H_Хэмминга.

Параметры (для данного r):

    n = 2^r - 1
    k = r
    d_min = 2^(r-1)

Свойства:

- Все ненулевые кодовые слова имеют одинаковый вес 2^(r-1).
- Расстояние между любыми двумя различными кодовыми словами одинаково и равно 2^(r-1).

---

## 11. Расширенный код Хэмминга

Расширение: к матрице H кода Хэмминга добавляется нулевой столбец и строка из единиц.

Параметры (для данного r):

    n = 2^r
    k = 2^r - 1 - r
    d_min = 4

По сути добавляется проверка на четность: длина кодового слова увеличивается на 1, минимальное расстояние увеличивается с 3 до 4.

Пример для r = 3: код Хэмминга (7, 4) расширяется до кода (8, 4) с d_min = 4.

---

## 12. Код Рида-Маллера первого порядка

Дуальный код к расширенному коду Хэмминга называется кодом Рида-Маллера первого порядка.

---

## 13. Сводка семейства кодов

    Код Хэмминга  ---(расширение)--->  Расширенный код Хэмминга
         |                                        |
      (дуальный)                              (дуальный)
         |                                        |
         v                                        v
    Симплексный код                    Код Рида-Маллера 1-го порядка

---

## 14. Анонс следующей лекции

На следующем занятии -- синдромное декодирование. Также будет домашнее задание: написать программу, демонстрирующую реальный эксперимент синдромного декодирования.
